$(function(){QUnit.module("scrollspy plugin");QUnit.test("should be defined on jquery object",function(a){a.expect(1);a.ok($(document.body).scrollspy,"scrollspy method is defined")});QUnit.module("scrollspy",{beforeEach:function(){$.fn.bootstrapScrollspy=$.fn.scrollspy.noConflict()},afterEach:function(){$.fn.scrollspy=$.fn.bootstrapScrollspy;delete $.fn.bootstrapScrollspy}});QUnit.test("should provide no conflict",function(a){a.expect(1);a.strictEqual($.fn.scrollspy,undefined,"scrollspy was set back to undefined (org value)")});QUnit.test("should throw explicit error on undefined method",function(a){a.expect(1);var b=$("<div/>").appendTo("#qunit-fixture");b.bootstrapScrollspy();try{b.bootstrapScrollspy("noMethod")}catch(c){a.strictEqual(c.message,'No method named "noMethod"')}});QUnit.test("should return jquery collection containing the element",function(a){a.expect(2);var c=$("<div/>").appendTo("#qunit-fixture");var b=c.bootstrapScrollspy();a.ok(b instanceof $,"returns jquery collection");a.strictEqual(b[0],c[0],"collection contains element")});QUnit.test('should only switch "active" class on current target',function(c){c.expect(1);var b=c.async();var a='<div id="root" class="active"><div class="topbar"><div class="topbar-inner"><div class="container" id="ss-target"><ul class="nav"><li class="nav-item"><a href="#masthead">Overview</a></li><li class="nav-item"><a href="#detail">Detail</a></li></ul></div></div></div><div id="scrollspy-example" style="height: 100px; overflow: auto;"><div style="height: 200px;"><h4 id="masthead">Overview</h4><p style="height: 200px">Ad leggings keytar, brunch id art party dolor labore.</p></div><div style="height: 200px;"><h4 id="detail">Detail</h4><p style="height: 200px">Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard.</p></div></div></div>';var e=$(a).appendTo("#qunit-fixture");var d=e.show().find("#scrollspy-example").bootstrapScrollspy({target:"#ss-target"});d.one("scroll",function(){c.ok(e.hasClass("active"),'"active" class still on root node');b()});d.scrollTop(350)});QUnit.test('should only switch "active" class on current target specified w element',function(c){c.expect(1);var b=c.async();var a='<div id="root" class="active"><div class="topbar"><div class="topbar-inner"><div class="container" id="ss-target"><ul class="nav"><li class="nav-item"><a href="#masthead">Overview</a></li><li class="nav-item"><a href="#detail">Detail</a></li></ul></div></div></div><div id="scrollspy-example" style="height: 100px; overflow: auto;"><div style="height: 200px;"><h4 id="masthead">Overview</h4><p style="height: 200px">Ad leggings keytar, brunch id art party dolor labore.</p></div><div style="height: 200px;"><h4 id="detail">Detail</h4><p style="height: 200px">Veniam marfa mustache skateboard, adipisicing fugiat velit pitchfork beard.</p></div></div></div>';var e=$(a).appendTo("#qunit-fixture");var d=e.show().find("#scrollspy-example").bootstrapScrollspy({target:document.getElementById("#ss-target")});d.one("scroll",function(){c.ok(e.hasClass("active"),'"active" class still on root node');b()});d.scrollTop(350)});QUnit.test("should correctly select middle navigation option when large offset is used",function(c){c.expect(3);var b=c.async();var a='<div id="header" style="height: 500px;"></div><nav id="navigation" class="navbar"><ul class="navbar-nav"><li class="nav-item active"><a class="nav-link" id="one-link" href="#one">One</a></li><li class="nav-item"><a class="nav-link" id="two-link" href="#two">Two</a></li><li class="nav-item"><a class="nav-link" id="three-link" href="#three">Three</a></li></ul></nav><div id="content" style="height: 200px; overflow-y: auto;"><div id="one" style="height: 500px;"></div><div id="two" style="height: 300px;"></div><div id="three" style="height: 10px;"></div></div>';var e=$(a).appendTo("#qunit-fixture");var d=e.show().filter("#content");d.bootstrapScrollspy({target:"#navigation",offset:d.position().top});d.one("scroll",function(){c.ok(!e.find("#one-link").hasClass("active"),'"active" class removed from first section');c.ok(e.find("#two-link").hasClass("active"),'"active" class on middle section');c.ok(!e.find("#three-link").hasClass("active"),'"active" class not on last section');b()});d.scrollTop(550)});QUnit.test("should add the active class to the correct element",function(b){b.expect(2);var f='<nav class="navbar"><ul class="nav"><li class="nav-item"><a class="nav-link" id="a-1" href="#div-1">div 1</a></li><li class="nav-item"><a class="nav-link" id="a-2" href="#div-2">div 2</a></li></ul></nav>';var e='<div class="content" style="overflow: auto; height: 50px"><div id="div-1" style="height: 100px; padding: 0; margin: 0">div 1</div><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div>';$(f).appendTo("#qunit-fixture");var c=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"});var a=b.async();var d=function(h,j){var g=$.Deferred();var i=Math.ceil(c.scrollTop()+$(j).position().top);c.one("scroll",function(){b.ok($(h).hasClass("active"),"target:"+j+", element"+h);g.resolve()});c.scrollTop(i);return g.promise()};$.when(d("#a-1","#div-1")).then(function(){return d("#a-2","#div-2")}).then(function(){a()})});QUnit.test("should add the active class to the correct element (nav markup)",function(b){b.expect(2);var f='<nav class="navbar"><nav class="nav"><a class="nav-link" id="a-1" href="#div-1">div 1</a><a class="nav-link" id="a-2" href="#div-2">div 2</a></nav></nav>';var e='<div class="content" style="overflow: auto; height: 50px"><div id="div-1" style="height: 100px; padding: 0; margin: 0">div 1</div><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div>';$(f).appendTo("#qunit-fixture");var c=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"});var a=b.async();var d=function(h,j){var g=$.Deferred();var i=Math.ceil(c.scrollTop()+$(j).position().top);c.one("scroll",function(){b.ok($(h).hasClass("active"),"target:"+j+", element"+h);g.resolve()});c.scrollTop(i);return g.promise()};$.when(d("#a-1","#div-1")).then(function(){return d("#a-2","#div-2")}).then(function(){a()})});QUnit.test("should add the active class to the correct element (list-group markup)",function(b){b.expect(2);var f='<nav class="navbar"><div class="list-group"><a class="list-group-item" id="a-1" href="#div-1">div 1</a><a class="list-group-item" id="a-2" href="#div-2">div 2</a></div></nav>';var e='<div class="content" style="overflow: auto; height: 50px"><div id="div-1" style="height: 100px; padding: 0; margin: 0">div 1</div><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div>';$(f).appendTo("#qunit-fixture");var c=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"});var a=b.async();var d=function(h,j){var g=$.Deferred();var i=Math.ceil(c.scrollTop()+$(j).position().top);c.one("scroll",function(){b.ok($(h).hasClass("active"),"target:"+j+", element"+h);g.resolve()});c.scrollTop(i);return g.promise()};$.when(d("#a-1","#div-1")).then(function(){return d("#a-2","#div-2")}).then(function(){a()})});QUnit.test("should add the active class correctly when there are nested elements at 0 scroll offset",function(b){b.expect(6);var g=0;var a=b.async();var f='<nav id="navigation" class="navbar"><ul class="nav"><li class="nav-item"><a id="a-1" class="nav-link" href="#div-1">div 1</a><ul class="nav"><li class="nav-item"><a id="a-2" class="nav-link" href="#div-2">div 2</a></li></ul></li></ul></nav>';var e='<div class="content" style="position: absolute; top: 0px; overflow: auto; height: 50px"><div id="div-1" style="padding: 0; margin: 0"><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div></div>';$(f).appendTo("#qunit-fixture");var d=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:"#navigation"});function c(){if(++g>3){return a()}d.one("scroll",function(){b.ok($("#a-1").hasClass("active"),'nav item for outer element has "active" class');b.ok($("#a-2").hasClass("active"),'nav item for inner element has "active" class');c()});d.scrollTop(d.scrollTop()+10)}c()});QUnit.test("should add the active class correctly when there are nested elements (nav markup)",function(b){b.expect(6);var g=0;var a=b.async();var f='<nav id="navigation" class="navbar"><nav class="nav"><a id="a-1" class="nav-link" href="#div-1">div 1</a><nav class="nav"><a id="a-2" class="nav-link" href="#div-2">div 2</a></nav></nav></nav>';var e='<div class="content" style="position: absolute; top: 0px; overflow: auto; height: 50px"><div id="div-1" style="padding: 0; margin: 0"><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div></div>';$(f).appendTo("#qunit-fixture");var d=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:"#navigation"});function c(){if(++g>3){return a()}d.one("scroll",function(){b.ok($("#a-1").hasClass("active"),'nav item for outer element has "active" class');b.ok($("#a-2").hasClass("active"),'nav item for inner element has "active" class');c()});d.scrollTop(d.scrollTop()+10)}c()});QUnit.test("should add the active class correctly when there are nested elements (list-group markup)",function(b){b.expect(6);var g=0;var a=b.async();var f='<nav id="navigation" class="navbar"><div class="list-group"><a id="a-1" class="list-group-item" href="#div-1">div 1</a><div class="list-group"><a id="a-2" class="list-group-item" href="#div-2">div 2</a></div></div></nav>';var e='<div class="content" style="position: absolute; top: 0px; overflow: auto; height: 50px"><div id="div-1" style="padding: 0; margin: 0"><div id="div-2" style="height: 200px; padding: 0; margin: 0">div 2</div></div></div>';$(f).appendTo("#qunit-fixture");var d=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:"#navigation"});function c(){if(++g>3){return a()}d.one("scroll",function(){b.ok($("#a-1").hasClass("active"),'nav item for outer element has "active" class');b.ok($("#a-2").hasClass("active"),'nav item for inner element has "active" class');c()});d.scrollTop(d.scrollTop()+10)}c()});QUnit.test("should clear selection if above the first section",function(d){d.expect(3);var c=d.async();var b='<div id="header" style="height: 500px;"></div><nav id="navigation" class="navbar"><ul class="navbar-nav"><li class="nav-item"><a id="one-link"   class="nav-link active" href="#one">One</a></li><li class="nav-item"><a id="two-link"   class="nav-link" href="#two">Two</a></li><li class="nav-item"><a id="three-link" class="nav-link" href="#three">Three</a></li></ul></nav>';$(b).appendTo("#qunit-fixture");var a='<div id="content" style="height: 200px; overflow-y: auto;"><div id="spacer" style="height: 100px;"/><div id="one" style="height: 100px;"/><div id="two" style="height: 100px;"/><div id="three" style="height: 100px;"/><div id="spacer" style="height: 100px;"/></div>';var e=$(a).appendTo("#qunit-fixture");e.bootstrapScrollspy({target:"#navigation",offset:e.position().top}).one("scroll",function(){d.strictEqual($(".active").length,1,'"active" class on only one element present');d.strictEqual($(".active").is("#two-link"),true,'"active" class on second section');e.one("scroll",function(){d.strictEqual($(".active").length,0,"selection cleared");c()}).scrollTop(0)}).scrollTop(201)});QUnit.test("should NOT clear selection if above the first section and first section is at the top",function(d){d.expect(4);var c=d.async();var b='<div id="header" style="height: 500px;"></div><nav id="navigation" class="navbar"><ul class="navbar-nav"><li class="nav-item"><a id="one-link"   class="nav-link active" href="#one">One</a></li><li class="nav-item"><a id="two-link"   class="nav-link" href="#two">Two</a></li><li class="nav-item"><a id="three-link" class="nav-link" href="#three">Three</a></li></ul></nav>';$(b).appendTo("#qunit-fixture");var g=-10;var f=101;var a='<div id="content" style="height: 200px; overflow-y: auto;"><div id="one" style="height: 100px;"/><div id="two" style="height: 100px;"/><div id="three" style="height: 100px;"/><div id="spacer" style="height: 100px;"/></div>';var e=$(a).appendTo("#qunit-fixture");e.bootstrapScrollspy({target:"#navigation",offset:e.position().top}).one("scroll",function(){d.strictEqual($(".active").length,1,'"active" class on only one element present');d.strictEqual($(".active").is("#two-link"),true,'"active" class on second section');e.one("scroll",function(){d.strictEqual($(".active").length,1,'"active" class on only one element present');d.strictEqual($(".active").is("#one-link"),true,'"active" class on first section');c()}).scrollTop(g)}).scrollTop(f)});QUnit.test("should correctly select navigation element on backward scrolling when each target section height is 100%",function(b){b.expect(5);var f='<nav class="navbar"><ul class="nav"><li class="nav-item"><a id="li-100-1" class="nav-link" href="#div-100-1">div 1</a></li><li class="nav-item"><a id="li-100-2" class="nav-link" href="#div-100-2">div 2</a></li><li class="nav-item"><a id="li-100-3" class="nav-link" href="#div-100-3">div 3</a></li><li class="nav-item"><a id="li-100-4" class="nav-link" href="#div-100-4">div 4</a></li><li class="nav-item"><a id="li-100-5" class="nav-link" href="#div-100-5">div 5</a></li></ul></nav>';var e='<div class="content" style="position: relative; overflow: auto; height: 100px"><div id="div-100-1" style="position: relative; height: 100%; padding: 0; margin: 0">div 1</div><div id="div-100-2" style="position: relative; height: 100%; padding: 0; margin: 0">div 2</div><div id="div-100-3" style="position: relative; height: 100%; padding: 0; margin: 0">div 3</div><div id="div-100-4" style="position: relative; height: 100%; padding: 0; margin: 0">div 4</div><div id="div-100-5" style="position: relative; height: 100%; padding: 0; margin: 0">div 5</div></div>';$(f).appendTo("#qunit-fixture");var c=$(e).appendTo("#qunit-fixture").bootstrapScrollspy({offset:0,target:".navbar"});var d=function(h,j){var g=$.Deferred();var i=Math.ceil(c.scrollTop()+$(j).position().top);c.one("scroll",function(){b.ok($(h).hasClass("active"),"target:"+j+", element: "+h);g.resolve()});c.scrollTop(i);return g.promise()};var a=b.async();$.when(d("#li-100-5","#div-100-5")).then(function(){return d("#li-100-4","#div-100-4")}).then(function(){return d("#li-100-3","#div-100-3")}).then(function(){return d("#li-100-2","#div-100-2")}).then(function(){return d("#li-100-1","#div-100-1")}).then(function(){a()})});QUnit.test("should allow passed in option offset method: offset",function(a){a.expect(4);var b=function(e){var f=$('<nav class="navbar"'+(e==="data"?' id="navbar-offset-method-menu"':"")+'><ul class="nav"><li class="nav-item"><a id="li-'+e+'m-1" class="nav-link" href="#div-'+e+'m-1">div 1</a></li><li class="nav-item"><a id="li-'+e+'m-2" class="nav-link" href="#div-'+e+'m-2">div 2</a></li><li class="nav-item"><a id="li-'+e+'m-3" class="nav-link" href="#div-'+e+'m-3">div 3</a></li></ul></nav>');var d=$('<div class="content"'+(e==="data"?' data-spy="scroll" data-target="#navbar-offset-method-menu" data-offset="0" data-method="offset"':"")+' style="position: relative; overflow: auto; height: 100px"><div id="div-'+e+'m-1" style="position: relative; height: 200px; padding: 0; margin: 0">div 1</div><div id="div-'+e+'m-2" style="position: relative; height: 150px; padding: 0; margin: 0">div 2</div><div id="div-'+e+'m-3" style="position: relative; height: 250px; padding: 0; margin: 0">div 3</div></div>');f.appendTo("#qunit-fixture");d.appendTo("#qunit-fixture");if(e==="js"){d.bootstrapScrollspy({target:".navbar",offset:0,method:"offset"})}else{if(e==="data"){$(window).trigger("load")}}var c=$("#div-"+e+"m-2");var g=d.data("bs.scrollspy");a.ok(g._offsets[1]===c.offset().top,"offset method with "+e+" option");a.ok(g._offsets[1]!==c.position().top,"position method with "+e+" option");f.remove();d.remove()};b("js");b("data")});QUnit.test("should allow passed in option offset method: position",function(a){a.expect(4);var b=function(e){var f=$('<nav class="navbar"'+(e==="data"?' id="navbar-offset-method-menu"':"")+'><ul class="nav"><li class="nav-item"><a class="nav-link" id="li-'+e+'m-1" href="#div-'+e+'m-1">div 1</a></li><li class="nav-item"><a class="nav-link" id="li-'+e+'m-2" href="#div-'+e+'m-2">div 2</a></li><li class="nav-item"><a class="nav-link" id="li-'+e+'m-3" href="#div-'+e+'m-3">div 3</a></li></ul></nav>');var d=$('<div class="content"'+(e==="data"?' data-spy="scroll" data-target="#navbar-offset-method-menu" data-offset="0" data-method="position"':"")+' style="position: relative; overflow: auto; height: 100px"><div id="div-'+e+'m-1" style="position: relative; height: 200px; padding: 0; margin: 0">div 1</div><div id="div-'+e+'m-2" style="position: relative; height: 150px; padding: 0; margin: 0">div 2</div><div id="div-'+e+'m-3" style="position: relative; height: 250px; padding: 0; margin: 0">div 3</div></div>');f.appendTo("#qunit-fixture");d.appendTo("#qunit-fixture");if(e==="js"){d.bootstrapScrollspy({target:".navbar",offset:0,method:"position"})}else{if(e==="data"){$(window).trigger("load")}}var c=$("#div-"+e+"m-2");var g=d.data("bs.scrollspy");a.ok(g._offsets[1]!==c.offset().top,"offset method with "+e+" option");a.ok(g._offsets[1]===c.position().top,"position method with "+e+" option");f.remove();d.remove()};b("js");b("data")})});