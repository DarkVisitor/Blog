$(function(){QUnit.module("dropdowns plugin");QUnit.test("should be defined on jquery object",function(a){a.expect(1);a.ok($(document.body).dropdown,"dropdown method is defined")});QUnit.module("dropdowns",{beforeEach:function(){$.fn.bootstrapDropdown=$.fn.dropdown.noConflict()},afterEach:function(){$.fn.dropdown=$.fn.bootstrapDropdown;delete $.fn.bootstrapDropdown}});QUnit.test("should provide no conflict",function(a){a.expect(1);a.strictEqual($.fn.dropdown,undefined,"dropdown was set back to undefined (org value)")});QUnit.test("should throw explicit error on undefined method",function(a){a.expect(1);var b=$("<div/>");b.bootstrapDropdown();try{b.bootstrapDropdown("noMethod")}catch(c){a.strictEqual(c.message,'No method named "noMethod"')}});QUnit.test("should return jquery collection containing the element",function(a){a.expect(2);var b=$("<div/>");var c=b.bootstrapDropdown();a.ok(c instanceof $,"returns jquery collection");a.strictEqual(c[0],b[0],"collection contains element")});QUnit.test("should not open dropdown if target is disabled via attribute",function(b){b.expect(1);var a=b.async();var c='<div class="tabs"><div class="dropdown"><button disabled href="#" class="btn dropdown-toggle" data-toggle="dropdown">Dropdown</button><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';$(c).appendTo("#qunit-fixture");var d=$("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.on("click",function(){b.ok(!d.parent(".dropdown").hasClass("show"));a()});d.trigger($.Event("click"))});QUnit.test('should set aria-expanded="true" on target when dropdown menu is shown',function(b){b.expect(1);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.strictEqual(d.attr("aria-expanded"),"true",'aria-expanded is set to string "true" on click');a()});d.trigger("click")});QUnit.test('should set aria-expanded="false" on target when dropdown menu is hidden',function(b){b.expect(1);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" aria-expanded="false" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("hidden.bs.dropdown",function(){b.strictEqual(d.attr("aria-expanded"),"false",'aria-expanded is set to string "false" on hide');a()});d.trigger("click");$(document.body).trigger("click")});QUnit.test("should not open dropdown if target is disabled via class",function(b){b.expect(1);var a=b.async();var c='<div class="tabs"><div class="dropdown"><button href="#" class="btn dropdown-toggle disabled" data-toggle="dropdown">Dropdown</button><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';$(c).appendTo("#qunit-fixture");var d=$("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.on("click",function(){b.ok(!d.parent(".dropdown").hasClass("show"));a()});d.trigger($.Event("click"))});QUnit.test("should add class show to menu if clicked",function(b){b.expect(1);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(d.parent(".dropdown").hasClass("show"),'"show" class added on click');a()});d.trigger("click")});QUnit.test("should test if element has a # before assuming it's a selector",function(b){b.expect(1);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="/foo/" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(d.parent(".dropdown").hasClass("show"),'"show" class added on click');a()});d.trigger("click")});QUnit.test('should remove "show" class if body is clicked',function(b){b.expect(2);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(d.parent(".dropdown").hasClass("show"),'"show" class added on click');$(document.body).trigger("click")}).on("hidden.bs.dropdown",function(){b.ok(!d.parent(".dropdown").hasClass("show"),'"show" class removed');a()});d.trigger("click")});QUnit.test('should remove "show" class if tabbing outside of menu',function(b){b.expect(2);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="dropdown-divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(d.parent(".dropdown").hasClass("show"),'"show" class added on click');var f=$.Event("keyup");f.which=9;$(document.body).trigger(f)}).on("hidden.bs.dropdown",function(){b.ok(!d.parent(".dropdown").hasClass("show"),'"show" class removed');a()});d.trigger("click")});QUnit.test('should remove "show" class if body is clicked, with multiple dropdowns',function(b){b.expect(7);var a=b.async();var d='<div class="nav"><div class="dropdown" id="testmenu"><a class="dropdown-toggle" data-toggle="dropdown" href="#testmenu">Test menu <span class="caret"/></a><div class="dropdown-menu"><a class="dropdown-item" href="#sub1">Submenu 1</a></div></div></div><div class="btn-group"><button class="btn">Actions</button><button class="btn dropdown-toggle" data-toggle="dropdown"></button><div class="dropdown-menu"><a class="dropdown-item" href="#">Action 1</a></div></div>';var f=$(d).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]');var e=f.first();var c=f.last();b.strictEqual(f.length,2,"two dropdowns");e.parent(".dropdown").on("shown.bs.dropdown",function(){b.strictEqual(e.parents(".show").length,1,'"show" class added on click');b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,1,"only one dropdown is shown");$(document.body).trigger("click")}).on("hidden.bs.dropdown",function(){b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,0,'"show" class removed');c.trigger("click")});c.parent(".btn-group").on("shown.bs.dropdown",function(){b.strictEqual(c.parent(".show").length,1,'"show" class added on click');b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,1,"only one dropdown is shown");$(document.body).trigger("click")}).on("hidden.bs.dropdown",function(){b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,0,'"show" class removed');a()});e.trigger("click")});QUnit.test('should remove "show" class if body if tabbing outside of menu, with multiple dropdowns',function(b){b.expect(7);var a=b.async();var d='<div class="nav"><div class="dropdown" id="testmenu"><a class="dropdown-toggle" data-toggle="dropdown" href="#testmenu">Test menu <span class="caret"/></a><div class="dropdown-menu"><a class="dropdown-item" href="#sub1">Submenu 1</a></div></div></div><div class="btn-group"><button class="btn">Actions</button><button class="btn dropdown-toggle" data-toggle="dropdown"><span class="caret"/></button><div class="dropdown-menu"><a class="dropdown-item" href="#">Action 1</a></div></div>';var f=$(d).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]');var e=f.first();var c=f.last();b.strictEqual(f.length,2,"two dropdowns");e.parent(".dropdown").on("shown.bs.dropdown",function(){b.strictEqual(e.parents(".show").length,1,'"show" class added on click');b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,1,"only one dropdown is shown");var g=$.Event("keyup");g.which=9;$(document.body).trigger(g)}).on("hidden.bs.dropdown",function(){b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,0,'"show" class removed');c.trigger("click")});c.parent(".btn-group").on("shown.bs.dropdown",function(){b.strictEqual(c.parent(".show").length,1,'"show" class added on click');b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,1,"only one dropdown is shown");var g=$.Event("keyup");g.which=9;$(document.body).trigger(g)}).on("hidden.bs.dropdown",function(){b.strictEqual($("#qunit-fixture .dropdown-menu.show").length,0,'"show" class removed');a()});e.trigger("click")});QUnit.test("should fire show and hide event",function(b){b.expect(2);var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();var a=b.async();d.parent(".dropdown").on("show.bs.dropdown",function(){b.ok(true,"show was fired")}).on("hide.bs.dropdown",function(){b.ok(true,"hide was fired");a()});d.trigger("click");$(document.body).trigger("click")});QUnit.test("should fire shown and hidden event",function(b){b.expect(2);var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();var a=b.async();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(true,"shown was fired")}).on("hidden.bs.dropdown",function(){b.ok(true,"hidden was fired");a()});d.trigger("click");$(document.body).trigger("click")});QUnit.test("should fire shown and hidden event with a relatedTarget",function(b){b.expect(2);var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();var a=b.async();d.parent(".dropdown").on("hidden.bs.dropdown",function(f){b.strictEqual(f.relatedTarget,d[0]);a()}).on("shown.bs.dropdown",function(f){b.strictEqual(f.relatedTarget,d[0]);$(document.body).trigger("click")});d.trigger("click")});QUnit.test("should ignore keyboard events within <input>s and <textarea>s",function(b){b.expect(3);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item" href="#">Secondary link</a><a class="dropdown-item" href="#">Something else here</a><div class="divider"/><a class="dropdown-item" href="#">Another link</a><input type="text" id="input"><textarea id="textarea"/></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();var f=$("#input");var e=$("#textarea");d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(true,"shown was fired");f.trigger("focus").trigger($.Event("keydown",{which:38}));b.ok($(document.activeElement).is(f),"input still focused");e.trigger("focus").trigger($.Event("keydown",{which:38}));b.ok($(document.activeElement).is(e),"textarea still focused");a()});d.trigger("click")});QUnit.test("should skip disabled element when using keyboard navigation",function(b){b.expect(2);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a class="dropdown-item disabled" href="#">Disabled link</a><a class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(true,"shown was fired");d.trigger($.Event("keydown",{which:40}));d.trigger($.Event("keydown",{which:40}));b.ok(!$(document.activeElement).is(".disabled"),".disabled is not focused");a()});d.trigger("click")});QUnit.test("should focus next/previous element when using keyboard navigation",function(b){b.expect(4);var a=b.async();var c='<div class="tabs"><div class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown</a><div class="dropdown-menu"><a id="item1" class="dropdown-item" href="#">A link</a><a id="item2" class="dropdown-item" href="#">Another link</a></div></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(true,"shown was fired");d.trigger($.Event("keydown",{which:40}));b.ok($(document.activeElement).is($("#item1")),"item1 is focused");$(document.activeElement).trigger($.Event("keydown",{which:40}));b.ok($(document.activeElement).is($("#item2")),"item2 is focused");$(document.activeElement).trigger($.Event("keydown",{which:38}));b.ok($(document.activeElement).is($("#item1")),"item1 is focused");a()});d.trigger("click")});QUnit.test("should not close the dropdown if the user clicks on a text field",function(b){b.expect(2);var a=b.async();var d='<div class="dropdown"><button type="button" data-toggle="dropdown">Dropdown</button><div class="dropdown-menu"><input id="textField" type="text" /></div></div>';var e=$(d).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();var c=$("#textField");c.on("click",function(){b.ok(e.parent(".dropdown").hasClass("show"),"dropdown menu is shown");a()});e.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(e.parent(".dropdown").hasClass("show"),"dropdown menu is shown");c.trigger($.Event("click"))});e.trigger("click")});QUnit.test("should not close the dropdown if the user clicks on a textarea",function(b){b.expect(2);var a=b.async();var c='<div class="dropdown"><button type="button" data-toggle="dropdown">Dropdown</button><div class="dropdown-menu"><textarea id="textArea"></textarea></div></div>';var d=$(c).appendTo("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();var e=$("#textArea");e.on("click",function(){b.ok(d.parent(".dropdown").hasClass("show"),"dropdown menu is shown");a()});d.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(d.parent(".dropdown").hasClass("show"),"dropdown menu is shown");e.trigger($.Event("click"))});d.trigger("click")});QUnit.test("Dropdown should not use Popper.js in navbar",function(b){b.expect(1);var a=b.async();var d='<nav class="navbar navbar-expand-md navbar-light bg-light"><div class="dropdown">  <a class="nav-link dropdown-toggle" href="#" id="dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>  <div class="dropdown-menu" aria-labelledby="dropdown">    <a class="dropdown-item" href="#">Action</a>    <a class="dropdown-item" href="#">Another action</a>    <a class="dropdown-item" href="#">Something else here</a>  </div></div></nav>';$(d).appendTo("#qunit-fixture");var e=$("#qunit-fixture").find('[data-toggle="dropdown"]').bootstrapDropdown();var c=e.next();e.parent(".dropdown").on("shown.bs.dropdown",function(){b.ok(c.attr("style")===undefined,"No inline style applied by Popper.js");a()});e.trigger($.Event("click"))})});