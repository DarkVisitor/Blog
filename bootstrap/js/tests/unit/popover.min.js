$(function(){QUnit.module("popover plugin");QUnit.test("should be defined on jquery object",function(a){a.expect(1);a.ok($(document.body).popover,"popover method is defined")});QUnit.module("popover",{beforeEach:function(){$.fn.bootstrapPopover=$.fn.popover.noConflict()},afterEach:function(){$.fn.popover=$.fn.bootstrapPopover;delete $.fn.bootstrapPopover;$(".popover").remove()}});QUnit.test("should provide no conflict",function(a){a.expect(1);a.strictEqual($.fn.popover,undefined,"popover was set back to undefined (org value)")});QUnit.test("should throw explicit error on undefined method",function(a){a.expect(1);var b=$("<div/>");b.bootstrapPopover();try{b.bootstrapPopover("noMethod")}catch(c){a.strictEqual(c.message,'No method named "noMethod"')}});QUnit.test("should return jquery collection containing the element",function(a){a.expect(2);var b=$("<div/>");var c=b.bootstrapPopover();a.ok(c instanceof $,"returns jquery collection");a.strictEqual(c[0],b[0],"collection contains element")});QUnit.test("should render popover element",function(b){b.expect(2);var a=b.async();$('<a href="#" title="mdo" data-content="https://twitter.com/mdo">@mdo</a>').appendTo("#qunit-fixture").on("shown.bs.popover",function(){b.notEqual($(".popover").length,0,"popover was inserted");$(this).bootstrapPopover("hide")}).on("hidden.bs.popover",function(){b.strictEqual($(".popover").length,0,"popover removed");a()}).bootstrapPopover("show")});QUnit.test("should store popover instance in popover data object",function(a){a.expect(1);var b=$('<a href="#" title="mdo" data-content="https://twitter.com/mdo">@mdo</a>').bootstrapPopover();a.ok(b.data("bs.popover"),"popover instance exists")});QUnit.test("should store popover trigger in popover instance data object",function(a){a.expect(1);var b=$('<a href="#" title="ResentedHook">@ResentedHook</a>').appendTo("#qunit-fixture").bootstrapPopover();b.bootstrapPopover("show");a.ok($(".popover").data("bs.popover"),"popover trigger stored in instance data")});QUnit.test("should get title and content from options",function(a){a.expect(4);var b=$('<a href="#">@fat</a>').appendTo("#qunit-fixture").bootstrapPopover({title:function(){return"@fat"},content:function(){return"loves writing tests Ôºà‚ïØ¬∞‚ñ°¬∞Ôºâ‚ïØÔ∏µ ‚îª‚îÅ‚î?"}});b.bootstrapPopover("show");a.notEqual($(".popover").length,0,"popover was inserted");a.strictEqual($(".popover .popover-header").text(),"@fat","title correctly inserted");a.strictEqual($(".popover .popover-body").text(),"loves writing tests Ôºà‚ïØ¬∞‚ñ°¬∞Ôºâ‚ïØÔ∏µ ‚îª‚îÅ‚î?","content correctly inserted");b.bootstrapPopover("hide");a.strictEqual($(".popover").length,0,"popover was removed")});QUnit.test("should allow DOMElement title and content (html: true)",function(a){a.expect(5);var d=document.createTextNode("@glebm <3 writing tests");var c=$("<i>¬Ø\\_(„É?)_/¬Ø</i>").get(0);var b=$('<a href="#" rel="tooltip"/>').appendTo("#qunit-fixture").bootstrapPopover({html:true,title:d,content:c});b.bootstrapPopover("show");a.notEqual($(".popover").length,0,"popover inserted");a.strictEqual($(".popover .popover-header").text(),"@glebm <3 writing tests","title inserted");a.ok($.contains($(".popover").get(0),d),"title node moved, not copied");a.strictEqual($(".popover .popover-body").html().toLowerCase(),"<i>¬Ø\\_(„É?)_/¬Ø</i>","content inserted");a.ok($.contains($(".popover").get(0),c),"content node moved, not copied")});QUnit.test("should allow DOMElement title and content (html: false)",function(a){a.expect(5);var d=document.createTextNode("@glebm <3 writing tests");var c=$("<i>¬Ø\\_(„É?)_/¬Ø</i>").get(0);var b=$('<a href="#" rel="tooltip"/>').appendTo("#qunit-fixture").bootstrapPopover({title:d,content:c});b.bootstrapPopover("show");a.notEqual($(".popover").length,0,"popover inserted");a.strictEqual($(".popover .popover-header").text(),"@glebm <3 writing tests","title inserted");a.ok(!$.contains($(".popover").get(0),d),"title node copied, not moved");a.strictEqual($(".popover .popover-body").html(),"¬Ø\\_(„É?)_/¬Ø","content inserted");a.ok(!$.contains($(".popover").get(0),c),"content node copied, not moved")});QUnit.test("should not duplicate HTML object",function(b){b.expect(6);var a=$("<div/>").html("loves writing tests Ôºà‚ïØ¬∞‚ñ°¬∞Ôºâ‚ïØÔ∏µ ‚îª‚îÅ‚î?");var c=$('<a href="#">@fat</a>').appendTo("#qunit-fixture").bootstrapPopover({html:true,content:function(){return a}});c.bootstrapPopover("show");b.notEqual($(".popover").length,0,"popover was inserted");b.equal($(".popover .popover-body").html(),a[0].outerHTML,"content correctly inserted");c.bootstrapPopover("hide");b.strictEqual($(".popover").length,0,"popover was removed");c.bootstrapPopover("show");b.notEqual($(".popover").length,0,"popover was inserted");b.equal($(".popover .popover-body").html(),a[0].outerHTML,"content correctly inserted");c.bootstrapPopover("hide");b.strictEqual($(".popover").length,0,"popover was removed")});QUnit.test("should get title and content from attributes",function(a){a.expect(4);var b=$('<a href="#" title="@mdo" data-content="loves data attributes („Å•ÔΩ°‚óï‚?ø‚?ø‚óïÔΩ?)„Å? Ô∏? ‚îª‚îÅ‚î?" >@mdo</a>').appendTo("#qunit-fixture").bootstrapPopover().bootstrapPopover("show");a.notEqual($(".popover").length,0,"popover was inserted");a.strictEqual($(".popover .popover-header").text(),"@mdo","title correctly inserted");a.strictEqual($(".popover .popover-body").text(),"loves data attributes („Å•ÔΩ°‚óï‚?ø‚?ø‚óïÔΩ?)„Å? Ô∏? ‚îª‚îÅ‚î?","content correctly inserted");b.bootstrapPopover("hide");a.strictEqual($(".popover").length,0,"popover was removed")});QUnit.test("should get title and content from attributes ignoring options passed via js",function(a){a.expect(4);var b=$('<a href="#" title="@mdo" data-content="loves data attributes („Å•ÔΩ°‚óï‚?ø‚?ø‚óïÔΩ?)„Å? Ô∏? ‚îª‚îÅ‚î?" >@mdo</a>').appendTo("#qunit-fixture").bootstrapPopover({title:"ignored title option",content:"ignored content option"}).bootstrapPopover("show");a.notEqual($(".popover").length,0,"popover was inserted");a.strictEqual($(".popover .popover-header").text(),"@mdo","title correctly inserted");a.strictEqual($(".popover .popover-body").text(),"loves data attributes („Å•ÔΩ°‚óï‚?ø‚?ø‚óïÔΩ?)„Å? Ô∏? ‚îª‚îÅ‚î?","content correctly inserted");b.bootstrapPopover("hide");a.strictEqual($(".popover").length,0,"popover was removed")});QUnit.test("should respect custom template",function(a){a.expect(3);var b=$('<a href="#">@fat</a>').appendTo("#qunit-fixture").bootstrapPopover({title:"Test",content:"Test",template:'<div class="popover foobar"><div class="arrow"></div><div class="inner"><h3 class="title"/><div class="content"><p/></div></div></div>'});b.bootstrapPopover("show");a.notEqual($(".popover").length,0,"popover was inserted");a.ok($(".popover").hasClass("foobar"),"custom class is present");b.bootstrapPopover("hide");a.strictEqual($(".popover").length,0,"popover was removed")});QUnit.test("should destroy popover",function(a){a.expect(7);var b=$("<div/>").bootstrapPopover({trigger:"hover"}).on("click.foo",$.noop);a.ok(b.data("bs.popover"),"popover has data");a.ok($._data(b[0],"events").mouseover&&$._data(b[0],"events").mouseout,"popover has hover event");a.strictEqual($._data(b[0],"events").click[0].namespace,"foo","popover has extra click.foo event");b.bootstrapPopover("show");b.bootstrapPopover("dispose");a.ok(!b.hasClass("show"),"popover is hidden");a.ok(!b.data("popover"),"popover does not have data");a.strictEqual($._data(b[0],"events").click[0].namespace,"foo","popover still has click.foo");a.ok(!$._data(b[0],"events").mouseover&&!$._data(b[0],"events").mouseout,"popover does not have any events")});QUnit.test("should render popover element using delegated selector",function(b){b.expect(2);var a=$('<div><a href="#" title="mdo" data-content="http://twitter.com/mdo">@mdo</a></div>').appendTo("#qunit-fixture").bootstrapPopover({selector:"a",trigger:"click"});a.find("a").trigger("click");b.notEqual($(".popover").length,0,"popover was inserted");a.find("a").trigger("click");b.strictEqual($(".popover").length,0,"popover was removed")});QUnit.test("should detach popover content rather than removing it so that event handlers are left intact",function(d){d.expect(1);var e=$('<div class="content-with-handler"><a class="btn btn-warning">Button with event handler</a></div>').appendTo("#qunit-fixture");var c=false;$(".content-with-handler .btn").on("click",function(){c=true});var b=$('<div><a href="#">Show popover</a></div>').appendTo("#qunit-fixture").bootstrapPopover({html:true,trigger:"manual",container:"body",content:function(){return e}});var a=d.async();b.one("shown.bs.popover",function(){b.one("hidden.bs.popover",function(){b.one("shown.bs.popover",function(){$(".content-with-handler .btn").trigger("click");b.bootstrapPopover("dispose");d.ok(c,"content's event handler still present");a()}).bootstrapPopover("show")}).bootstrapPopover("hide")}).bootstrapPopover("show")});QUnit.test("should do nothing when an attempt is made to hide an uninitialized popover",function(a){a.expect(1);var b=$('<span data-toggle="popover" data-title="some title" data-content="some content">some text</span>').appendTo("#qunit-fixture").on("hidden.bs.popover shown.bs.popover",function(){a.ok(false,"should not fire any popover events")}).bootstrapPopover("hide");a.strictEqual(b.data("bs.popover"),undefined,"should not initialize the popover")});QUnit.test("should fire inserted event",function(b){b.expect(2);var a=b.async();$('<a href="#">@Johann-S</a>').appendTo("#qunit-fixture").on("inserted.bs.popover",function(){b.notEqual($(".popover").length,0,"popover was inserted");b.ok(true,"inserted event fired");a()}).bootstrapPopover({title:"Test",content:"Test"}).bootstrapPopover("show")});QUnit.test("should throw an error when show is called on hidden elements",function(b){b.expect(1);var a=b.async();try{$('<div data-toggle="popover" data-title="some title" data-content="@Johann-S" style="display: none"/>').bootstrapPopover("show")}catch(c){b.strictEqual(c.message,"Please use show on visible elements");a()}});QUnit.test("should hide popovers when their containing modal is closed",function(b){b.expect(1);var a=b.async();var c='<div id="modal-test" class="modal"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"><button id="popover-test" type="button" class="btn btn-secondary" data-toggle="popover" data-placement="top" data-content="Popover">Popover on top</button></div></div></div></div>';$(c).appendTo("#qunit-fixture");$("#popover-test").on("shown.bs.popover",function(){$("#modal-test").modal("hide")}).on("hide.bs.popover",function(){b.ok(true,"popover hide");a()});$("#modal-test").on("shown.bs.modal",function(){$("#popover-test").bootstrapPopover("show")}).modal("show")});QUnit.test("should convert number to string without error for content and title",function(b){b.expect(2);var a=b.async();var c=$('<a href="#">@mdo</a>').appendTo("#qunit-fixture").bootstrapPopover({title:5,content:7}).on("shown.bs.popover",function(){b.strictEqual($(".popover .popover-header").text(),"5");b.strictEqual($(".popover .popover-body").text(),"7");a()});c.bootstrapPopover("show")})});